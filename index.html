<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ø°ÙƒØ±Ø§Øª ÙˆØ§Ù„Ø·Ø¨Ø§Ø¹Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        
        /* CSS Ù„Ù„ØªØµÙ…ÙŠÙ… (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ø§Ù„Ø£Ù†ÙŠÙ‚) */
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --background-color: #ecf0f1;
            --card-background: #ffffff;
            --border-radius: 10px;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 20px;
            color: var(--primary-color);
            direction: rtl;
            text-align: right;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--card-background);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: var(--secondary-color);
            margin-bottom: 30px;
            border-bottom: 3px solid var(--secondary-color);
            padding-bottom: 10px;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }

        .input-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
        }

        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 1.1em;
        }

        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
        }
        input[type="number"]::before {
            content: attr(step);
        }


        button {
            width: 100%;
            padding: 15px;
            background-color: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            margin-top: 20px;
            font-weight: bold;
        }

        button:hover:not(:disabled) {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background-color: #bdc3c7; /* Ù„ÙˆÙ† Ø±Ù…Ø§Ø¯ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø·ÙŠÙ„ */
            cursor: not-allowed;
        }

        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .result-card {
            background-color: var(--card-background);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            text-align: center;
            border-right: 5px solid var(--secondary-color);
            transition: transform 0.3s;
        }

        .result-card:hover {
            transform: translateY(-5px);
        }

        .result-card h3 {
            color: var(--primary-color);
            margin-top: 0;
            font-size: 1.2em;
        }

        .result-card .value {
            font-size: 2em;
            font-weight: 700;
            color: var(--accent-color);
            margin: 10px 0 0;
        }

        #total-profit-card {
            grid-column: 1 / -1;
            border-right: 5px solid #27ae60;
        }
        
        .category-heading {
            grid-column: 1 / -1;
            background-color: var(--secondary-color);
            color: white;
            padding: 10px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-top: 20px;
            font-size: 1.5em;
        }
        .category-heading:first-child {
            margin-top: 0;
        }

        .percentage-card {
             border-right: 5px solid #f39c12;
        }

        .remaining-card {
             border-right: 5px solid #9b59b6;
        }

        @media (max-width: 900px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“Š Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø°ÙƒØ±Ø§Øª ÙˆØ§Ù„Ù…ÙƒØ§Ø³Ø¨ </h1>
    <div class="main-grid">
        <div class="input-section">
            <h2>ğŸ“ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª)</h2>
            <form id="calculation-form">
                <div class="input-group">
                    <label for="b1">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ (b1)</label>
                    <input type="number" id="b1" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b2">Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹ (b2)</label>
                    <input type="number" id="b2" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b3">Ø³Ø¹Ø± Ø§Ù„Ù…Ø°ÙƒØ±Ø© (b3)</label>
                    <input type="number" id="b3" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b4">Ø³Ø¹Ø± Ø§Ù„ÙˆØ±Ù‚Ø© ØªØµÙˆÙŠØ± (b4)</label>
                    <input type="number" id="b4" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b5">Ø³Ø¹Ø± Ø§Ù„ÙˆØ±Ù‚Ø© Ø¨ÙŠØ¹ (b5)</label>
                    <input type="number" id="b5" required min="0" step="any">
                </div>
                <hr>
                <div class="input-group">
                    <label for="b6">Ø³Ø¹Ø± Ø¨Ø§ÙƒØª Ø§Ù„ÙˆØ±Ù‚ (b6)</label>
                    <input type="number" id="b6" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b7">Ø³Ø¹Ø± Ø§Ù„Ø­Ø¨Ø± (b7)</label>
                    <input type="number" id="b7" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b8">Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (Ù…ØµØ±ÙˆÙ Ø«Ø§Ø¨Øª) (b8)</label>
                    <input type="number" id="b8" required min="0" step="any">
                </div>
                <div class="input-group">
                    <label for="b9">Ù…ØµØ±ÙˆÙØ§Øª Ø£Ø®Ø±Ù‰ (b9)</label>
                    <input type="number" id="b9" required min="0" step="any">
                </div>
                 <div class="input-group">
                    <label for="b10">Ø§Ù„ØµÙŠØ§Ù†Ø© (b10)</label>
                    <input type="number" id="b10" required min="0" step="any">
                </div>

                <button type="submit">Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸš€</button>
            </form>
        </div>

        <div class="results-container">
            <h2>ğŸ’° Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</h2>
            
            <button type="button" onclick="downloadResults()" style="background-color: #2ecc71; margin-bottom: 20px;" disabled id="download-btn">
                ğŸ“¥ ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙƒÙ…Ù„Ù (Excel/CSV)
            </button>
            
            <div class="results-section" id="results">
                <p style="grid-column: 1 / -1; text-align: center; color: #7f8c8d;">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬" Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù‡Ù†Ø§.</p>
            </div>
        </div>

    </div>
</div>

<script>
    // JavaScript Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
    document.getElementById('calculation-form').addEventListener('submit', function(e) {
        e.preventDefault();
        calculateResults();
    });

    function calculateResults() {
        // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
        const b1 = parseFloat(document.getElementById('b1').value) || 0;
        const b2 = parseFloat(document.getElementById('b2').value) || 0;
        const b3 = parseFloat(document.getElementById('b3').value) || 0;
        const b4 = parseFloat(document.getElementById('b4').value) || 0;
        const b5 = parseFloat(document.getElementById('b5').value) || 0;
        const b6 = parseFloat(document.getElementById('b6').value) || 0;
        const b7 = parseFloat(document.getElementById('b7').value) || 0;
        const b8 = parseFloat(document.getElementById('b8').value) || 0;
        const b9 = parseFloat(document.getElementById('b9').value) || 0;
        const b10 = parseFloat(document.getElementById('b10').value) || 0;

        // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© (Ù„Ø§ ØªØºÙŠÙŠØ± ÙÙŠÙ‡Ø§)
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '';

        const renderCard = (title, value, typeClass = '') => {
            const card = document.createElement('div');
            card.className = `result-card ${typeClass}`;
            card.innerHTML = `
                <h3>${title}</h3>
                <p class="value">${(Math.round(value * 100) / 100).toLocaleString('ar-EG', { minimumFractionDigits: 2 })}</p>
            `;
            resultsDiv.appendChild(card);
        };
        
        const renderCategoryHeading = (title) => {
            const heading = document.createElement('h2');
            heading.className = 'category-heading';
            heading.textContent = title;
            resultsDiv.appendChild(heading);
        };
        
        // --- Ø¨Ø¯Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ---

        // 1. Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© 
        renderCategoryHeading('1. Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙˆØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©');
        const totalAmount = b1 * b3;
        renderCard('Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ù…Ø°ÙƒØ±Ø§Øª (b1 * b3)', totalAmount);
        const totalPapersPrinted = b1 * b2;
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹ (b1 * b2)', totalPapersPrinted);
        const totalPrintingCost = b1 * b2 * b4;
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø¹Ø± Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„ØªÙƒÙ„ÙØ©) (b1 * b2 * b4)', totalPrintingCost);
        const totalPaperSales = b1 * b2 * b5;
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø¹Ø± Ø¨ÙŠØ¹ Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯) (b1 * b2 * b5)', totalPaperSales);
        const totalPrintingProfit = totalPaperSales - totalPrintingCost;
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…ÙƒØ³Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØ±Ù‚', totalPrintingProfit, 'total-profit-card');

        // 2. Ø¬Ù…Ù„Ø© ØªÙƒÙ„ÙØ© ÙˆÙ…ÙƒØ³Ø¨ Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©)
        renderCategoryHeading('2. Ø¬Ù…Ù„Ø© ØªÙƒÙ„ÙØ© ÙˆÙ…ÙƒØ³Ø¨ Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©)');
        let totalPaperCostPerUnit = 0;
        if (totalPapersPrinted !== 0) {
            const actualPaperCost = (b6 / 500) * totalPapersPrinted;
            let averageInkInternetCost = 0;
            if ((b2 + b1) !== 0) {
                averageInkInternetCost = (b7 + b8) / (b2 + b1);
            }
            totalPaperCostPerUnit = actualPaperCost + averageInkInternetCost;
        }
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¬Ù…Ù„Ø© Ø§Ù„ÙˆØ±Ù‚Ø© (Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„ÙˆØ±Ù‚Ø©)', totalPaperCostPerUnit);
        const totalPaperProfitNew = totalPaperSales - totalPaperCostPerUnit;
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…ÙƒØ³Ø¨ Ø¬Ù…Ù„Ø© Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ - Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„ÙˆØ±Ù‚Ø©)', totalPaperProfitNew, 'total-profit-card');
        
        // 3. Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ (Ù…ÙƒØ³Ø¨ Ø§Ù„Ù…Ø°ÙƒØ±Ø©)
        renderCategoryHeading('3. ØªÙˆØ²ÙŠØ¹ Ù…ÙƒØ³Ø¨ Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ');
        const grossMemoProfit = totalAmount - totalPrintingCost;
        const doctorShare = grossMemoProfit * 0.70;
        renderCard('Ù†Ø³Ø¨Ø© Ø¯ÙƒØªÙˆØ± Ø§Ù„Ù…Ø§Ø¯Ø© (70% Ù…Ù† Ø§Ù„Ù…ÙƒØ³Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ù…Ø°ÙƒØ±Ø©)', doctorShare, 'percentage-card');
        const moustafaShare1 = (grossMemoProfit * 0.30) / 4;
        renderCard('Ù†Ø³Ø¨Ø© Ù…ÙˆØ³Ù‰ 1 (30% Ù…Ù† Ø§Ù„Ù…ÙƒØ³Ø¨ / 4)', moustafaShare1, 'percentage-card');

        // 4. Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹ (Ø±ØµÙŠØ¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©)
        renderCategoryHeading('4. ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ²ÙŠØ¹ Ù…Ù† Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©');
        const distributableBalance = totalPrintingCost - totalPaperSales;
        const uniShare = distributableBalance * 0.30;
        renderCard('Ù†Ø³Ø¨Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© (30% Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ²ÙŠØ¹)', uniShare, 'percentage-card');
        const maintenanceShare = distributableBalance * 0.15;
        renderCard('Ù†Ø³Ø¨Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© (15% Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ²ÙŠØ¹)', maintenanceShare, 'percentage-card');
        const internetShare = distributableBalance * 0.05;
        renderCard('Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (5% Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ²ÙŠØ¹)', internetShare, 'percentage-card');
        const moustafaShare2 = distributableBalance * 0.10;
        renderCard('Ù†Ø³Ø¨Ø© Ù…ÙˆØ³Ù‰ 2 (10% Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªÙˆØ²ÙŠØ¹)', moustafaShare2, 'percentage-card');
        const totalMoustafaShare = moustafaShare2 + moustafaShare1;
        renderCard('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù†Ø³Ø¨Ø© Ù…ÙˆØ³Ù‰ (Ù…ÙˆØ³Ù‰ 1 + Ù…ÙˆØ³Ù‰ 2)', totalMoustafaShare, 'total-profit-card');

        // 5. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
        renderCategoryHeading('5. Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©');
        const internetRemaining = internetShare - b9;
        renderCard('Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø¥Ù†ØªØ±Ù†Øª (Ø§Ù„Ù†Ø³Ø¨Ø© - Ù…ØµØ±ÙˆÙØ§Øª Ø£Ø®Ø±Ù‰ b9)', internetRemaining, 'remaining-card');
        const maintenanceRemaining = maintenanceShare - b10;
        renderCard('Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„ØµÙŠØ§Ù†Ø© (Ø§Ù„Ù†Ø³Ø¨Ø© - Ù…ØµØ±ÙˆÙ Ø§Ù„ØµÙŠØ§Ù†Ø© b10)', maintenanceRemaining, 'remaining-card');

        // ØªÙ…ÙƒÙŠÙ† Ø²Ø± Ø§Ù„ØªÙ†Ø²ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­
        document.getElementById('download-btn').disabled = false;
    }


    // --------------------------------------------------------------------------------
    // Ø¯Ø§Ù„Ø© ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙƒÙ…Ù„Ù CSV (ÙŠÙØªØ­ Ø¨Ø¨Ø±Ù†Ø§Ù…Ø¬ Excel)
    // --------------------------------------------------------------------------------

    function downloadResults() {
        // Ù‚Ø±Ø§Ø¡Ø© ÙƒØ§ÙØ© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© (ÙŠØ¬Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨Ù‡Ø§ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ ÙÙŠ Ù…Ù„Ù CSV)
        const b1 = parseFloat(document.getElementById('b1').value) || 0;
        const b2 = parseFloat(document.getElementById('b2').value) || 0;
        const b3 = parseFloat(document.getElementById('b3').value) || 0;
        const b4 = parseFloat(document.getElementById('b4').value) || 0;
        const b5 = parseFloat(document.getElementById('b5').value) || 0;
        const b6 = parseFloat(document.getElementById('b6').value) || 0;
        const b7 = parseFloat(document.getElementById('b7').value) || 0;
        const b8 = parseFloat(document.getElementById('b8').value) || 0;
        const b9 = parseFloat(document.getElementById('b9').value) || 0;
        const b10 = parseFloat(document.getElementById('b10').value) || 0;

        // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ø¬Ù…Ø¹Ù‡Ø§ ÙÙŠ Ù…Ù„Ù CSV
        const totalAmount = b1 * b3;
        const totalPapersPrinted = b1 * b2;
        const totalPrintingCost = b1 * b2 * b4;
        const totalPaperSales = b1 * b2 * b5;
        const totalPrintingProfit = totalPaperSales - totalPrintingCost;
        
        // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¬Ù…Ù„Ø© Ø§Ù„ÙˆØ±Ù‚Ø© (Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©)
        let totalPaperCostPerUnit = 0;
        if (totalPapersPrinted !== 0) {
            const actualPaperCost = (b6 / 500) * totalPapersPrinted;
            let averageInkInternetCost = 0;
            if ((b2 + b1) !== 0) {
                averageInkInternetCost = (b7 + b8) / (b2 + b1);
            }
            totalPaperCostPerUnit = actualPaperCost + averageInkInternetCost;
        }
        const totalPaperProfitNew = totalPaperSales - totalPaperCostPerUnit;
        
        // Ù…ÙƒØ³Ø¨ Ø§Ù„Ù…Ø°ÙƒØ±Ø© Ù„Ù„ØªÙˆØ²ÙŠØ¹
        const grossMemoProfit = totalAmount - totalPrintingCost;
        const doctorShare = grossMemoProfit * 0.70;
        const moustafaShare1 = (grossMemoProfit * 0.30) / 4;
        
        // Ø±ØµÙŠØ¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ù„Ù„ØªÙˆØ²ÙŠØ¹
        const distributableBalance = totalPrintingCost - totalPaperSales;
        const uniShare = distributableBalance * 0.30;
        const maintenanceShare = distributableBalance * 0.15;
        const internetShare = distributableBalance * 0.05;
        const moustafaShare2 = distributableBalance * 0.10;
        const totalMoustafaShare = moustafaShare2 + moustafaShare1;
        
        // Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
        const internetRemaining = internetShare - b9;
        const maintenanceRemaining = maintenanceShare - b10;


        // 1. ØªÙ†Ø³ÙŠÙ‚ Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© (Header)
        // Ø¥Ø¶Ø§ÙØ© UTF-8 BOM (\ufeff) Ù„Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ÙÙŠ Excel
        let csvContent = "Ø§Ù„Ù…ØªØºÙŠØ±,Ø§Ù„Ù‚ÙŠÙ…Ø©,Ø§Ù„ÙˆØµÙ\n";

        // 2. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª (Inputs)
        csvContent += `Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨,${b1},b1\n`;
        csvContent += `Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹,${b2},b2\n`;
        csvContent += `Ø³Ø¹Ø± Ø§Ù„Ù…Ø°ÙƒØ±Ø©,${b3},b3\n`;
        csvContent += `Ø³Ø¹Ø± Ø§Ù„ÙˆØ±Ù‚Ø© ØªØµÙˆÙŠØ±,${b4},b4\n`;
        csvContent += `Ø³Ø¹Ø± Ø§Ù„ÙˆØ±Ù‚Ø© Ø¨ÙŠØ¹,${b5},b5\n`;
        csvContent += `Ø³Ø¹Ø± Ø¨Ø§ÙƒØª Ø§Ù„ÙˆØ±Ù‚,${b6},b6\n`;
        csvContent += `Ø³Ø¹Ø± Ø§Ù„Ø­Ø¨Ø±,${b7},b7\n`;
        csvContent += `Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª (Ù…ØµØ±ÙˆÙ Ø«Ø§Ø¨Øª),${b8},b8\n`;
        csvContent += `Ù…ØµØ±ÙˆÙØ§Øª Ø£Ø®Ø±Ù‰,${b9},b9\n`;
        csvContent += `Ø§Ù„ØµÙŠØ§Ù†Ø© (Ù…ØµØ±ÙˆÙ Ø«Ø§Ø¨Øª),${b10},b10\n`;

        csvContent += "\nØ§Ù„Ù†ØªØ§Ø¦Ø¬,Ø§Ù„Ù‚ÙŠÙ…Ø©,Ø§Ù„Ù†ÙˆØ¹\n"; // ÙØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø®Ø±Ø¬Ø§Øª

        // 3. ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª (Results)
        csvContent += `Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ù…Ø°ÙƒØ±Ø§Øª,${totalAmount.toFixed(2)},Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±Ù‚ Ø§Ù„Ù…Ø·Ø¨ÙˆØ¹,${totalPapersPrinted.toFixed(0)},Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø¹Ø± Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„ØªÙƒÙ„ÙØ©),${totalPrintingCost.toFixed(2)},Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø¹Ø± Ø¨ÙŠØ¹ Ø§Ù„ÙˆØ±Ù‚ (Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯),${totalPaperSales.toFixed(2)},Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…ÙƒØ³Ø¨ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙˆØ±Ù‚,${totalPrintingProfit.toFixed(2)},Ø§Ù„Ù…ÙƒØ³Ø¨\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¬Ù…Ù„Ø© Ø§Ù„ÙˆØ±Ù‚Ø© (Ø§Ù„ØªÙƒÙ„ÙØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©),${totalPaperCostPerUnit.toFixed(2)},Ø¬Ù…Ù„Ø© Ø§Ù„ØªÙƒÙ„ÙØ©\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…ÙƒØ³Ø¨ Ø¬Ù…Ù„Ø© Ø§Ù„ÙˆØ±Ù‚,${totalPaperProfitNew.toFixed(2)},Ø§Ù„Ù…ÙƒØ³Ø¨\n`;
        csvContent += `Ù†Ø³Ø¨Ø© Ø¯ÙƒØªÙˆØ± Ø§Ù„Ù…Ø§Ø¯Ø©,${doctorShare.toFixed(2)},Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹\n`;
        csvContent += `Ù†Ø³Ø¨Ø© Ù…ÙˆØ³Ù‰ 1,${moustafaShare1.toFixed(2)},Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹\n`;
        csvContent += `Ù†Ø³Ø¨Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©,${uniShare.toFixed(2)},Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹\n`;
        csvContent += `Ù†Ø³Ø¨Ø© Ø§Ù„ØµÙŠØ§Ù†Ø©,${maintenanceShare.toFixed(2)},Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹\n`;
        csvContent += `Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª,${internetShare.toFixed(2)},Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹\n`;
        csvContent += `Ù†Ø³Ø¨Ø© Ù…ÙˆØ³Ù‰ 2,${moustafaShare2.toFixed(2)},Ù†Ø³Ø¨ Ø§Ù„ØªÙˆØ²ÙŠØ¹\n`;
        csvContent += `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù†Ø³Ø¨Ø© Ù…ÙˆØ³Ù‰,${totalMoustafaShare.toFixed(2)},Ø§Ù„Ù…ÙƒØ³Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ\n`;
        csvContent += `Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø¥Ù†ØªØ±Ù†Øª,${internetRemaining.toFixed(2)},Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ\n`;
        csvContent += `Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„ØµÙŠØ§Ù†Ø©,${maintenanceRemaining.toFixed(2)},Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ\n`;

        // 4. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„ØªÙ†Ø²ÙŠÙ„
        const blob = new Blob(["\ufeff" + csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.setAttribute('href', url);
        
        const date = new Date().toLocaleDateString('sv-SE').replace(/-/g, '');
        link.setAttribute('download', `Memo_Calculations_${date}.csv`);
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        alert("ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¨Ø¨Ø±Ù†Ø§Ù…Ø¬ Excel.");
    }

    // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù„Ø¶Ù…Ø§Ù† Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('download-btn').disabled = true;
    });
</script>

</body>
</html>
